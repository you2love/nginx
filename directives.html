<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nginx 指令详解 - 核心配置指南</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <header class="header">
        <div class="container">
            <div class="logo">
                <h1>Nginx 深度学习</h1>
                <p class="tagline">揭秘内部机制，掌握核心配置</p>
            </div>
            <nav class="nav">
                <a href="index.html" class="nav-link">首页</a>
                <a href="mechanism.html" class="nav-link">内部机制</a>
                <a href="request-flow.html" class="nav-link">请求处理</a>
                <a href="directives.html" class="nav-link active">指令详解</a>
                <a href="configs.html" class="nav-link">应用配置</a>
            </nav>
        </div>
    </header>

    <main>
        <section class="section">
            <div class="container">
                <h1 class="page-title">Nginx 指令详解</h1>
                <p class="page-intro">全面掌握Nginx核心指令及其使用场景</p>
            </div>
        </section>


        <section class="section">
            <div class="container">
                <h2 class="section-title">最常用指令详解</h2>
                
                <h3 class="section-subtitle">核心配置指令</h3>
                <table class="info-table">
                    <thead>
                        <tr><th>指令</th><th>默认值</th><th>作用域</th><th>说明</th></tr>
                    </thead>
                    <tbody>
                        <tr><td><code>worker_processes</code></td><td>1</td><td>main</td><td>Worker进程数量，通常设为CPU核心数</td></tr>
                        <tr><td><code>worker_connections</code></td><td>1024</td><td>events</td><td>每个Worker的最大连接数</td></tr>
                        <tr><td><code>daemon</code></td><td>on</td><td>main</td><td>是否以守护进程运行</td></tr>
                        <tr><td><code>error_log</code></td><td>logs/error.log</td><td>main, http, server, location</td><td>错误日志路径和级别</td></tr>
                        <tr><td><code>pid</code></td><td>logs/nginx.pid</td><td>main</td><td>主进程PID文件路径</td></tr>
                    </tbody>
                </table>

                <h3 class="section-subtitle">HTTP核心指令</h3>
                <table class="info-table">
                    <thead>
                        <tr><th>指令</th><th>默认值</th><th>作用域</th><th>说明</th></tr>
                    </thead>
                    <tbody>
                        <tr><td><code>server</code></td><td>-</td><td>http</td><td>定义虚拟服务器</td></tr>
                        <tr><td><code>location</code></td><td>-</td><td>server, location</td><td>匹配请求URI</td></tr>
                        <tr><td><code>listen</code><td>80</td><td>server</td><td>监听端口和地址</td></tr>
                        <tr><td><code>server_name</code><td>""</td><td>server</td><td>虚拟主机名</td></tr>
                        <tr><td><code>root</code></td><td>html</td><td>http, server, location</td><td>网站根目录</td></tr>
                        <tr><td><code>index</code><td>index.html</td><td>http, server, location</td><td>默认首页文件</td></tr>
                    </tbody>
                </table>

                <h3 class="section-subtitle">代理相关指令</h3>
                <table class="info-table">
                    <thead>
                        <tr><th>指令</th><th>默认值</th><th>作用域</th><th>说明</th></tr>
                    </thead>
                    <tbody>
                        <tr><td><code>proxy_pass</code></td><td>-</td><td>location, if in location</td><td>代理服务器地址</td></tr>
                        <tr><td><code>proxy_set_header</code></td><td>-</td><td>http, server, location</td><td>设置代理请求头</td></tr>
                        <tr><td><code>proxy_connect_timeout</code></td><td>60s</td><td>http, server, location</td><td>连接超时时间</td></tr>
                        <tr><td><code>proxy_read_timeout</code></td><td>60s</td><td>http, server, location</td><td>读取超时时间</td></tr>
                        <tr><td><code>proxy_send_timeout</code></td><td>60s</td><td>http, server, location</td><td>发送超时时间</td></tr>
                    </tbody>
                </table>

                <h3 class="section-subtitle">缓存指令</h3>
                <table class="info-table">
                    <thead>
                        <tr><th>指令</th><th>默认值</th><th>作用域</th><th>说明</th></tr>
                    </thead>
                    <tbody>
                        <tr><td><code>proxy_cache</code></td><td>off</td><td>http, server, location</td><td>启用代理缓存</td></tr>
                        <tr><td><code>proxy_cache_path</code></td><td>-</td><td>http</td><td>定义缓存路径和参数</td></tr>
                        <tr><td><code>proxy_cache_valid</code><td>-</td><td>http, server, location</td><td>缓存有效时间</td></tr>
                        <tr><td><code>expires</code><td>off</td><td>http, server, location</td><td>缓存过期时间</td></tr>
                    </tbody>
                </table>

                <h3 class="section-subtitle">负载均衡指令</h3>
                <table class="info-table">
                    <thead>
                        <tr><th>指令</th><th>默认值</th><th>作用域</th><th>说明</th></tr>
                    </thead>
                    <tbody>
                        <tr><td><code>upstream</code><td>-</td><td>http</td><td>定义后端服务器组</td></tr>
                        <tr><td><code>server</code><td>-</td><td>upstream</td><td>定义后端服务器</td></tr>
                        <tr><td><code>least_conn</code><td>-</td><td>upstream</td><td>最少连接策略</td></tr>
                        <tr><td><code>ip_hash</code><td>-</td><td>upstream</td><td>IP哈希策略</td></tr>
                    </tbody>
                </table>
            </div>
        </section>

        <section class="section">
            <div class="container">
                <h3 class="section-subtitle">SSL/TLS指令</h3>
                <table class="info-table">
                    <thead>
                        <tr><th>指令</th><th>默认值</th><th>作用域</th><th>说明</th></tr>
                    </thead>
                    <tbody>
                        <tr><td><code>ssl</code></td><td>off</td><td>http, server</td><td>启用SSL</td></tr>
                        <tr><td><code>ssl_certificate</code><td>-</td><td>http, server</td><td>证书文件路径</td></tr>
                        <tr><td><code>ssl_certificate_key</code><td>-</td><td>http, server</td><td>私钥文件路径</td></tr>
                        <tr><td><code>ssl_protocols</code><td>TLSv1 TLSv1.1 TLSv1.2 TLSv1.3</td><td>http, server</td><td>支持的SSL协议</td></tr>
                    </tbody>
                </table>

                <h3 class="section-subtitle">访问控制指令</h3>
                <table class="info-table">
                    <thead>
                        <tr><th>指令</th><th>默认值</th><th>作用域</th><th>说明</th></tr>
                    </thead>
                    <tbody>
                        <tr><td><code>allow</code></td><td>-</td><td>http, server, location</td><td>允许访问的IP</td></tr>
                        <tr><td><code>deny</code></td><td>-</td><td>http, server, location</td><td>拒绝访问的IP</td></tr>
                        <tr><td><code>auth_basic</code></td><td>off</td><td>http, server, location</td><td>启用基本认证</td></tr>
                    </tbody>
                </table>

                <h3 class="section-subtitle">性能优化指令</h3>
                <table class="info-table">
                    <thead>
                        <tr><th>指令</th><th>默认值</th><th>作用域</th><th>说明</th></tr>
                    </thead>
                    <tbody>
                        <tr><td><code>sendfile</code></td><td>on</td><td>http, server, location</td><td>启用零拷贝传输</td></tr>
                        <tr><td><code>tcp_nopush</code></td><td>on</td><td>http, server, location</td><td>优化TCP包发送</td></tr>
                        <tr><td><code>gzip</code></td><td>off</td><td>http, server, location</td><td>启用gzip压缩</td></tr>
                        <tr><td><code>gzip_comp_level</code></td><td>1</td><td>http, server, location</td><td>压缩级别(1-9)</td></tr>
                        <tr><td><code>keepalive_timeout</code></td><td>75s</td><td>http, server, location</td><td>长连接超时</td></tr>
                    </tbody>
                </table>
            </div>
        </section>
    </main>

</body>
</html>
        <section class="section bg-light">
            <div class="container">
                <h2 class="section-title">指令常用参数值</h2>
                
                <h3 class="section-subtitle">worker_processes 参数值</h3>
                <table class="info-table">
                    <thead>
                        <tr><th>值</th><th>说明</th></tr>
                    </thead>
                    <tbody>
                        <tr><td><code>1</code></td><td>默认值，单进程模式</td></tr>
                        <tr><td><code>auto</code></td><td>自动检测CPU核心数</td></tr>
                        <tr><td><code>2, 4, 8...</code></td><td>指定进程数量</td></tr>
                    </tbody>
                </table>

                <h3 class="section-subtitle">error_log 级别值</h3>
                <table class="info-table">
                    <thead>
                        <tr><th>级别</th><th>说明</th></tr>
                    </thead>
                    <tbody>
                        <tr><td><code>debug</code></td><td>调试信息</td></tr>
                        <tr><td><code>info</code></td><td>信息消息</td></tr>
                        <tr><td><code>notice</code></td><td>通知消息</td></tr>
                        <tr><td><code>warn</code></td><td>警告消息</td></tr>
                        <tr><td><code>error</code></td><td>错误消息（默认）</td></tr>
                        <tr><td><code>crit</code></td><td>严重错误</td></tr>
                        <tr><td><code>alert</code></td><td>警报</td></tr>
                        <tr><td><code>emerg</code></td><td>紧急情况</td></tr>
                    </tbody>
                </table>

                <h3 class="section-subtitle">location 匹配优先级</h3>
                <table class="info-table">
                    <thead>
                        <tr><th>优先级</th><th>匹配规则</th><th>说明</th></tr>
                    </thead>
                    <tbody>
                        <tr><td>1</td><td><code>= /path</code></td><td>精确匹配，优先级最高</td></tr>
                        <tr><td>2</td><td><code>^~ /path</code></td><td>前缀匹配，停止正则搜索</td></tr>
                        <tr><td>3</td><td><code>~ pattern</code></td><td>正则匹配（区分大小写）</td></tr>
                        <tr><td>4</td><td><code>~* pattern</code></td><td>正则匹配（不区分大小写）</td></tr>
                        <tr><td>5</td><td><code>/path</code></td><td>前缀匹配，优先级最低</td></tr>
                    </tbody>
                </table>

                <h3 class="section-subtitle">proxy_set_header 常用值</h3>
                <table class="info-table">
                    <thead>
                        <tr><th>参数</th><th>说明</th></tr>
                    </thead>
                    <tbody>
                        <tr><td><code>Host $host</code></td><td>传递原始Host头</td></tr>
                        <tr><td><code>X-Real-IP $remote_addr</code></td><td>传递客户端真实IP</td></tr>
                        <tr><td><code>X-Forwarded-For $proxy_add_x_forwarded_for</code></td><td>传递代理链路</td></tr>
                        <tr><td><code>X-Forwarded-Proto $scheme</code></td><td>传递原始协议</td></tr>
                    </tbody>
                </table>
            </div>
        </section>
    </main>

</body>
</html>
